services:
  - couchdb
notifications:
  email: false
before_install:
  - "gem install bundler --version 1.11.2"
before_script:
  - "rm .ruby-version"
  - "mv config/ci/travis/ruby-version .ruby-version"
  - "config/ci/travis/setup_couch.sh"
  - "mv config/ci/travis/couchdb.admin.yml config/couchdb.admin.yml"
  - "mv config/ci/travis/couchdb.yml config/couchdb.yml"
  - "bundle exec rake RAILS_ENV=test db:rotate"
  - "bundle exec rake RAILS_ENV=test db:migrate"
after_script:
  - "cat tmp/*.test*.log" # printing logs from the failed integration tests
bundler_args: --without development debug
